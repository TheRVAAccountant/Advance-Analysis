2025-05-27 17:52:48 - root - INFO - Logging initialized - Level: INFO, File: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\logs\advance_analysis_20250527_175248.log
2025-05-27 17:52:48 - advance_analysis.main - INFO - Starting Advance Analysis Tool
2025-05-27 17:52:48 - advance_analysis.main - INFO - Launching main GUI
2025-05-27 17:52:48 - advance_analysis.gui.status_bar - INFO - Status: Ready
2025-05-27 17:52:59 - advance_analysis.gui.file_selection_widget - INFO - Added to recent files (advance_analysis): C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 Advance Analysis 15 May 2025  Final.xlsx
2025-05-27 17:52:59 - advance_analysis.gui.file_selection_widget - INFO - Selected file: C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 Advance Analysis 15 May 2025  Final.xlsx
2025-05-27 17:53:15 - advance_analysis.gui.file_selection_widget - INFO - Added to recent files (current_dhstier): C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 TrialBalance20250410_024311PM.xlsx
2025-05-27 17:53:15 - advance_analysis.gui.file_selection_widget - INFO - Selected file: C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 TrialBalance20250410_024311PM.xlsx
2025-05-27 17:53:22 - advance_analysis.gui.file_selection_widget - INFO - Added to recent files (prior_dhstier): C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY24 Q4 TrialBalance20241011_080140AM.xlsx
2025-05-27 17:53:22 - advance_analysis.gui.file_selection_widget - INFO - Selected file: C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY24 Q4 TrialBalance20241011_080140AM.xlsx
2025-05-27 17:53:31 - advance_analysis.gui.status_bar - INFO - Status: Processing data...
2025-05-27 17:53:31 - advance_analysis.gui.gui - INFO - Starting data processing for component: WMD, period: FY25 Q2
2025-05-27 17:53:31 - advance_analysis.gui.gui - INFO - Loading Excel file: C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 Advance Analysis 15 May 2025  Final.xlsx
2025-05-27 17:53:31 - advance_analysis.modules.data_loader - INFO - Loading file: C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 Advance Analysis 15 May 2025  Final.xlsx
2025-05-27 17:53:31 - advance_analysis.modules.data_loader - INFO - Sheet names in file: ['1-Instructions', '2-Certification', '3-PY Q4 Ending Balance', '4-Advance Analysis', '5-FY18 Scorecard Metrics', '6-ADVANCE TO TIER Recon SUMMARY', 'Version Control', 'DO USE Only']
2025-05-27 17:53:31 - advance_analysis.modules.data_loader - INFO - Searching for header row with term 'TAS' in column A
2025-05-27 17:53:32 - advance_analysis.modules.data_loader - INFO - Found header row at index 9 (row 10 in Excel)
2025-05-27 17:53:32 - advance_analysis.modules.data_loader - INFO - Headers found: ['TAS', 'SGL', 'DHS Doc No', 'Indicate if advance is to WCF (Y/N)', 'Advance/Prepayment', 'Date of Advance', 'Age of Advance (days)', 'Last Activity Date', 'Anticipated Liquidation Date', 'Period of Performance End Date']...
2025-05-27 17:53:32 - advance_analysis.modules.data_loader - INFO - Total columns identified: 16
2025-05-27 17:53:32 - advance_analysis.modules.data_loader - INFO - Using intelligent header detection: skiprows=9, usecols up to column 15
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Excel file loaded successfully
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Processing data
2025-05-27 17:53:33 - advance_analysis.core.data_processing_simple - INFO - Processing data for WMD FY25 Q2
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Initialized AdvanceAnalysisProcessor for WMD
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Current Reporting Date: 03/31/2025
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Fiscal Year Start Date: 10/01/2024
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Starting advance data processing
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Initial DataFrame shape: (8, 16)
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Initial columns: ['TAS', 'SGL', 'DHS Doc No', 'Indicate if advance is to WCF (Y/N)', 'Advance/Prepayment', 'Date of Advance', 'Age of Advance (days)', 'Last Activity Date', 'Anticipated Liquidation Date', 'Period of Performance End Date', 'Status', 'Advance/Prepayment.1', 'Comments', 'Vendor', ' Trading Partner ID', 'Advance Type (e.g. Travel, Vendor Prepayment)']
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Validating and cleaning data
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - All required columns present. Total columns: 16
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Transforming date columns
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - WARNING - Date of Advance: 8 out of 8 values could not be converted to dates
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - WARNING - Last Activity Date: 8 out of 8 values could not be converted to dates
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - WARNING - Anticipated Liquidation Date: 8 out of 8 values could not be converted to dates
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - WARNING - Period of Performance End Date: 8 out of 8 values could not be converted to dates
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Setting column types
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Removing extra columns
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - No extra columns to remove
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Filtering valid rows (non-null TAS)
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Filtered out 0 rows with null TAS
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Remaining rows: 8
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding DO Concatenate column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding PoP Expired? column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - PoP Expired statistics:
PoP Expired?
Missing PoP Date    8
Name: count, dtype: int64
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding Days Since PoP Expired column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding Invoiced Within the Last 12 Months column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Invoice activity statistics:
Invoiced Within the Last 12 Months
Last Invoice Date Missing    8
Name: count, dtype: int64
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding Active/Inactive Advance column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Active/Inactive advance statistics:
Active/Inactive Advance
No Invoice Activity Reported    8
Name: count, dtype: int64
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding Abnormal Balance column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Abnormal balance statistics:
Abnormal Balance
N    8
Name: count, dtype: int64
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Adding CY Advance? column
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Current year advance statistics:
CY Advance?
Date of Advance Not Available    8
Name: count, dtype: int64
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Processing complete. Final DataFrame shape: (8, 23)
2025-05-27 17:53:33 - advance_analysis.core.advance_analysis_processing - INFO - Final columns: ['TAS', 'SGL', 'DHS Doc No', 'Indicate if advance is to WCF (Y/N)', 'Advance/Prepayment', 'Date of Advance', 'Age of Advance (days)', 'Last Activity Date', 'Anticipated Liquidation Date', 'Period of Performance End Date', 'Status', 'Advance/Prepayment.1', 'Comments', 'Vendor', ' Trading Partner ID', 'Advance Type (e.g. Travel, Vendor Prepayment)', 'DO Concatenate', 'PoP Expired?', 'Days Since PoP Expired', 'Invoiced Within the Last 12 Months', 'Active/Inactive Advance', 'Abnormal Balance', 'CY Advance?']
2025-05-27 17:53:33 - advance_analysis.core.data_processing_simple - INFO - Advanced analysis processing completed successfully
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Data processed successfully
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Created output folder: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333
2025-05-27 17:53:33 - advance_analysis.modules.file_handler - INFO - File copied from C:/Users/Jeron.Crooks/VSCode/Advance Analysis/src/inputs/WMD FY25 Q2 Advance Analysis 15 May 2025  Final.xlsx to c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333\WMD FY25 Q2 Advance Analysis - DO.xlsx
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Input file copied and renamed: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333\WMD FY25 Q2 Advance Analysis - DO.xlsx
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Saving processed data to: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333\WMD FY25 Q2 Advance Analysis Review.xlsx
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Processed data saved successfully
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Formatting Excel file
2025-05-27 17:53:33 - advance_analysis.modules.excel_handler - INFO - Starting to format Excel file: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333\WMD FY25 Q2 Advance Analysis Review.xlsx
2025-05-27 17:53:33 - advance_analysis.modules.excel_handler - INFO - Excel file formatted successfully: c:\Users\Jeron.Crooks\VSCode\Advance Analysis\outputs\WMD FY25 Q2 Advance Analysis 20250527_175333\WMD FY25 Q2 Advance Analysis Review.xlsx
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Excel file formatted successfully
2025-05-27 17:53:33 - advance_analysis.gui.gui - INFO - Processing Excel files using advanced method
2025-05-27 17:53:33 - advance_analysis.modules.excel_handler - INFO - Starting Excel file processing for WMD
2025-05-27 17:53:45 - advance_analysis.modules.excel_handler - INFO - Sheet names in input workbook:
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 1-Instructions
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 2-Certification
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 3-PY Q4 Ending Balance
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 4-Advance Analysis
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 5-FY18 Scorecard Metrics
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - 6-ADVANCE TO TIER Recon SUMMARY
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - Version Control
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO -   - DO USE Only
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - WARNING - Sheet '6-ADVANCE TO TIER Recon Summary' not found with exact match. Trying case-insensitive search...
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO - Found similar sheet: '6-ADVANCE TO TIER Recon SUMMARY'. Using this instead.
2025-05-27 17:53:46 - advance_analysis.modules.excel_handler - INFO - Copying 'DO Tab 4 Review' sheet
2025-05-27 17:53:47 - advance_analysis.modules.excel_handler - INFO - Sheet 'DO Tab 4 Review' copied successfully at position 7
2025-05-27 17:53:47 - advance_analysis.modules.excel_handler - INFO - Copying current year DHSTIER sheet
2025-05-27 17:53:48 - advance_analysis.modules.excel_handler - INFO - Sheet 'WMD Total' copied successfully and renamed to 'DO CY TB' at position 8
2025-05-27 17:53:48 - advance_analysis.modules.excel_handler - INFO - Copying prior year DHSTIER sheet
2025-05-27 17:53:50 - advance_analysis.modules.excel_handler - INFO - Sheet 'WMD Total' copied successfully and renamed to 'DO PY TB' at position 9
2025-05-27 17:53:50 - advance_analysis.modules.excel_handler - INFO - Creating pivot table in sheet: 3-PY Q4 Ending Balance
2025-05-27 17:53:51 - advance_analysis.modules.excel_handler - INFO - TAS cell found at row 6, column 1
2025-05-27 17:53:52 - advance_analysis.modules.excel_handler - INFO - Last populated column in header row: H
2025-05-27 17:53:52 - advance_analysis.modules.excel_handler - INFO - Header row values in '3-PY Q4 Ending Balance' sheet:
2025-05-27 17:53:53 - advance_analysis.modules.excel_handler - INFO -   Column A (index 1): TAS
2025-05-27 17:53:53 - advance_analysis.modules.excel_handler - INFO -   Column B (index 2): DHS Doc No
2025-05-27 17:53:54 - advance_analysis.modules.excel_handler - INFO -   Column C (index 3): Advance/Prepayment
2025-05-27 17:53:56 - advance_analysis.modules.excel_handler - INFO -   Column D (index 4): Advance/Prepayment
2025-05-27 17:53:56 - advance_analysis.modules.excel_handler - INFO -   Column E (index 5): Status
2025-05-27 17:53:56 - advance_analysis.modules.excel_handler - INFO -   Column F (index 6): Date of Advance
2025-05-27 17:53:57 - advance_analysis.modules.excel_handler - INFO -   Column G (index 7): Date of Advance - Age
2025-05-27 17:53:57 - advance_analysis.modules.excel_handler - INFO -   Column H (index 8): Last Activity Date
2025-05-27 17:53:57 - advance_analysis.modules.excel_handler - INFO - Total columns with headers: 8
2025-05-27 17:54:02 - advance_analysis.modules.excel_handler - INFO - Last populated row after header row: 14
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Pivot table range: $A$6:$H$14
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Searching for Advance/Prepayment column...
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Found Advance/Prepayment column at index 3 (column C): 'Advance/Prepayment'
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Using column 'Advance/Prepayment' for pivot table
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Creating pivot table...
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Pivot table data range: $A$6:$H$14
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Pivot table destination: Cell I6 (column 9)
2025-05-27 17:54:03 - advance_analysis.modules.excel_handler - INFO - Pivot cache created successfully
2025-05-27 17:54:04 - advance_analysis.modules.excel_handler - INFO - Pivot table created successfully
2025-05-27 17:54:04 - advance_analysis.modules.excel_handler - INFO - Adding 'Advance/Prepayment' field to pivot table values...
2025-05-27 17:54:04 - advance_analysis.modules.excel_handler - INFO - Available pivot fields:
2025-05-27 17:54:04 - advance_analysis.modules.excel_handler - INFO -   Field 1: TAS
2025-05-27 17:54:04 - advance_analysis.modules.excel_handler - INFO -   Field 2: DHS Doc No
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 3: Advance/Prepayment
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 4: Advance/Prepayment2
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 5: Status
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 6: Date of Advance
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 7: Date of Advance - Age
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO -   Field 8: Last Activity Date
2025-05-27 17:54:05 - advance_analysis.modules.excel_handler - INFO - Successfully set pivot field orientation and function
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Pivot table created successfully with sum in cell $I$7
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Pivot table or summary calculation created successfully
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Sum cell address: $I$7
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Sum cell address: $I$7
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Creating tickmark legend and comparing values
2025-05-27 17:54:06 - advance_analysis.modules.excel_handler - INFO - Creating tickmark legend in sheet: 2-Certification
2025-05-27 17:54:10 - advance_analysis.modules.excel_handler - INFO - Tickmark legend created successfully
2025-05-27 17:54:11 - advance_analysis.modules.excel_handler - ERROR - PY Q4 Ending Balance not found in Certification sheet
2025-05-27 17:54:11 - advance_analysis.modules.excel_handler - INFO - Modifying Obligation Analysis sheet
2025-05-27 17:54:11 - advance_analysis.modules.excel_handler - ERROR - Error in advanced modifications to Obligation Analysis sheet: Required sheets not found
Traceback (most recent call last):
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 929, in modify_obligation_analysis_sheet
    raise ValueError("Required sheets not found")
ValueError: Required sheets not found
2025-05-27 17:54:11 - advance_analysis.modules.excel_handler - ERROR - Error in modify_obligation_analysis_sheet: Required sheets not found
Traceback (most recent call last):
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 57, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 929, in modify_obligation_analysis_sheet
    raise ValueError("Required sheets not found")
ValueError: Required sheets not found
2025-05-27 17:54:11 - advance_analysis.modules.excel_handler - ERROR - Value error in Excel processing: Required sheets not found
2025-05-27 17:54:12 - advance_analysis.modules.excel_handler - ERROR - Error in process_excel_files: Required sheets not found
Traceback (most recent call last):
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 57, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 738, in process_excel_files
    last_column, header_row, sum_udo_balance_col2 = modify_obligation_analysis_sheet(input_wb, password, component)
                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 57, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 929, in modify_obligation_analysis_sheet
    raise ValueError("Required sheets not found")
ValueError: Required sheets not found
2025-05-27 17:54:12 - advance_analysis.gui.gui - ERROR - Error in Excel file processing: Required sheets not found
Traceback (most recent call last):
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\gui\gui.py", line 1224, in _process_data_thread
    process_excel_files(
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 57, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 738, in process_excel_files
    last_column, header_row, sum_udo_balance_col2 = modify_obligation_analysis_sheet(input_wb, password, component)
                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 57, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Jeron.Crooks\VSCode\Advance Analysis\src\advance_analysis\modules\excel_handler.py", line 929, in modify_obligation_analysis_sheet
    raise ValueError("Required sheets not found")
ValueError: Required sheets not found
2025-05-27 17:54:12 - advance_analysis.gui.gui - ERROR - Error occurred: Error in Excel file processing: Required sheets not found
2025-05-27 17:54:41 - advance_analysis.main - INFO - Advance Analysis Tool shutting down
